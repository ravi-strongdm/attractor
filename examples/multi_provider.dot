// multi_provider.dot — three codergen nodes using all three LLM providers
//
// Flow:
//   start → plan[anthropic] → implement[openai] → review[gemini] → done
//
// Each node selects a different provider via the `model` attribute.
// To run this pipeline ANTHROPIC_API_KEY, OPENAI_API_KEY, and GEMINI_API_KEY
// must all be set.
// `attractor lint` validates the graph structure without requiring API keys.
digraph multi_provider {
    // ── Nodes ────────────────────────────────────────────────────────
    start [type=start]

    plan  [type=codergen,
           model="anthropic:claude-sonnet-4-6",
           prompt="Analyse the repository structure and write a concise plan for the feature: {{ .seed }}"]

    impl  [type=codergen,
           model="openai:gpt-4o",
           prompt="Implement the following plan in the current working directory.\n\nPlan:\n{{ .plan_output }}"]

    review [type=codergen,
            model="gemini:gemini-2.0-flash",
            prompt="Review the implementation and summarise any issues.\n\nImplementation output:\n{{ .impl_output }}",
            max_turns="3"]

    done  [type=exit]

    // ── Edges ────────────────────────────────────────────────────────
    start  -> plan
    plan   -> impl
    impl   -> review
    review -> done
}
